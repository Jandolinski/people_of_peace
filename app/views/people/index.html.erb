
<div id="map"></div>
<script>
    function initMap() {
        var startingLocation = {lat: <%= Person.last.try!(:latitude) %>, lng: <%= Person.last.try!(:longitude) %>};
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 4,
            <%= Person.last ? 'center: startingLocation' : '' %>
        });

        <% Person.all.each_with_index do |person, index| %>
        var person<%= index + 1 %> = {lat: <%= person.latitude %>, lng: <%= person.longitude %>};
        var markerPerson<%= index + 1 %> = new google.maps.Marker({
            position: person<%= index + 1 %>,
            map: map
        });

        <% end %>
        <% User.all.each_with_index do |coordinator, i| %>
        var supervisor<%= i %> = {lat: <%= coordinator.latitude %>, lng: <%= coordinator.longitude %>};
        var markerCoo<%= i %> = new google.maps.Marker({
            position: supervisor<%= i %>,
            icon: "<%= asset_path('koordynator.png') %>",
            map: map
        });
        var contentString2<%= i %> = '<div id="content">'+
                '<div id="siteNotice">'+
                '</div>'+
                '<h1 id="firstHeading" class="firstHeading"><%= coordinator.name%></h1>'+
                '<div id="bodyContent">'+
                '<p>Email: <%= coordinator.email %></p>' +
                '<p>Tel. <%= coordinator.phone %></p>' +
                '<p>FB: <%= coordinator.fb %></p>' +
                '<p>Skype: <%= coordinator.skype %></p>' +
                '<p>Adres: <%= coordinator.city %></p>' +
                '</div>'+
                '</div>';
        var infowindow2<%= i %> = new google.maps.InfoWindow({
            content: contentString2<%= i %>
        });
        markerCoo<%= i %>.addListener('click', function() {
            infowindow2<%= i %>.open(map, markerCoo<%= i %>);
        });
        <% end %>
    }
</script>

<div class="booyah-box">
    <table class="table table-hover">
      <thead>
        <tr>
          <th><%= t('name') %></th>
          <th><%= t('city') %></th>
          <th><%= t('fellowship') %></th>
          <th><%= t('background') %></th>
          <th><%= t('status') %></th>
          <th><%= t('added_by') %></th>
          <th><%= t('coordinator') %></th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @people.each do |person| %>
          <tr>
            <td><%= person.name %></td>
            <td><%= person.city %></td>
            <td><%= person.fellowship %></td>
            <td><%= person.background %></td>
            <td><%= person.status %></td>
            <td><%= person.user.try!(:name) %></td>
            <td><%= person.coordinator.try(:name) %></td>
            <td><%= link_to t('show'), person %></td>
            <td><%= link_to t('edit'), edit_person_path(person) %></td>
            <td><%= link_to t('destroy'), person, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
</div>